<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<script type='text/javascript' src='localizedStrings.js' charset='utf-8'></script>
		<style type="text/css">
			@import "Organized.css";
		</style>
		<script>
			var loadAnimator;
			var todoController;
			var clockController;
			var noteController;
			var eventsController;
			var tabController;
			var calendarController;
			var updateController;
			var p;
		</script>		<script type='text/javascript' src='Menu.js'></script>				<script type='text/javascript' src='Menuitem.js'></script>				<script type='text/javascript' src='Animator.js'></script>
		<script type='text/javascript' src='AnimationObject.js'></script>
		<script type='text/javascript' src='Scripts/StretcherMain.js'></script>
		<script type='text/javascript' src='Scripts/Stretcher.js'></script>
		<script type='text/javascript' src='./AppleClasses/AppleScrollArea.js' charset='utf-8'/>
		<script type='text/javascript' src='./AppleClasses/AppleScrollbar.js' charset='utf-8'/>
		<script type='text/javascript' src='dash.js'></script>				<script type='text/javascript' src='Prefs.js'></script>				<script type='text/javascript' src='TabController.js'></script>				<script type='text/javascript' src='Calendar.js'></script>				<script type='text/javascript' src='TodoObject.js'></script>				<script type='text/javascript' src='ClockObject.js'></script>				<script type='text/javascript' src='NoteObject.js'></script>				<script type='text/javascript' src='EventObject.js'></script>				<script type='text/javascript' src='EventHeader.js'></script>				<script type='text/javascript' src='Clocks.js'></script>				<script type='text/javascript' src='Notes.js'></script>				<script type='text/javascript' src='Events.js'></script>				<script type='text/javascript' src='Todos.js'></script>				<script type='text/javascript' src='PrefClockObject.js'></script>				<script type='text/javascript' src='PrefSearchResultObject.js'></script>				<script type='text/javascript' src='Updater.js'></script>			</head>	<body onload="setTimeout('doSetup()', 300)">
	<img id="loading-image" src="Default.png" style="position:absolute;top:0px;left:0px" />
	<div id="front" onmouseover="showFlip()" onmouseout="hideFlip()" class="focus" style='position:absolute;opacity:0'>
		<div id='flip' class='flip' onclick='showbackside()'></div>	
		<div class='top'>
			<div style="background-color:black;z-index:100;width:196px;height:235px;position:absolute;top:15px;left:25px;opacity:0.8;display:none" id="update-fader-top"></div>	
			<div class='cal-headerdate ellipsis' id="main-date"></div>
			<div style="height:22px;position:absolute;top:215px;left:23px;">
				<div onclick="calendarController.calendarBack(null, false, false)" class="calendar-back"></div>
				<div onclick="calendarController.calendarReset()" class="calendar-reset"></div>
				<div onclick="calendarController.calendarForward(null, false, false)" class="calendar-forward"></div>
				<div class="calmonth" id="calendarmonth"></div>
			</div>
			<div class="calendar-row calendar-row0" style="left:25px;top:42px;">
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-0">S</div></div>
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-1">M</div></div>
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-2">T</div></div>
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-3">W</div></div>
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-4">T</div></div>
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-5">F</div></div>
				<div class="calendar-day-cell calendar-day-cell-name"><div class="calendar-dayname-text" id="calendar-dayname-6">S</div></div>
			</div>
			<div style="height:150px;overflow:hidden;position:absolute;top:60px;width:196px;left:25px;">
				<div id="calendar-contents"></div>
			</div>
		</div>
		<div style='height:20px;top:238px;' class="middle">
			<div style="background-color:black;z-index:100;width:196px;height:21px;position:absolute;left:25px;opacity:0.8;display:none" id="update-fader-nav"></div>	
			<div id="tab-button-clocks" class="tab tab-clocks tab-unselected" onclick="tabController.selectTab(0)"></div>
			<div id="tab-button-notes" class="tab tab-notes tab-unselected" onclick="tabController.selectTab(1)"></div>
			<div id="tab-button-events" class="tab tab-events tab-unselected" onclick="tabController.selectTab(2)"></div>
			<div id="tab-button-todo" class="tab tab-todos tab-unselected" onclick="tabController.selectTab(3)"></div>
		</div>
		
		<div id="main-background" class="middle" style="top:258px;"></div>
		<div id="main-base" class="base"></div>
		
		<div id="tab-container" style="">
			<div style="background-color:black;z-index:100;width:196px;height:100%;position:absolute;left:25px;opacity:0.8;display:none" id="update-fader-tabs"></div>	
			<div id="tab-clocks" style="visibility:hidden;">
				<div id="clock-contents" class="clock-mode-large">
					<div id="clock-contents-inner"></div>
				</div>
			</div>

			<div id="tab-notes" style='z-index:1;height:196px;width:196px;position:absolute;top:0px;overflow:hidden;visibility:hidden;left:25px;'>
				<div style="position:absolute;top:0px;left:0px;" id="note-index-container">
					<div class="note-item-header">
						<div style="position:absolute;top:2px;left:25px;width:146px;font-size:12px;text-align:center"><span id="note-index-count-label"></span> (<span id="note-index-count">0</span>)</div>
						<div class="note-button-new" onclick="noteController.addNote()"></div>
					</div>
					<div style='overflow:hidden;position:absolute;top:23px;' id="note-index-scroller-container">
						<div class="note-index" id="note-index-content"></div>
					</div>
					<div class="note-base" id="note-index-base" style="bottom:0px;"></div>
					<div id="note-index-scroller" class="note-scroller" style="position:absolute;top:28px;left:180px;height:160px;width:10px;"></div>
					<div id="note-index-resizer" style="position:absolute;bottom:3px;left:181px;background-image:url(./images/scrollbar/resize.png);height:12px;width:12px;-apple-dashboard-region: dashboard-region(control rectangle);" onmousedown="noteController.beginResizeDrag(event)"></div>
				</div>
				<div style="position:absolute;top:0px;left:0px;width:196px;display:none;" id="note-item-container">
					<div class="note-item-header">
						<div class="note-button-new" onclick="noteController.addNote()"></div>
						<div class="note-button-back" onclick="noteController.selectIndex()"></div>
						<div style="position:absolute;height:14px;left:25px;width:146px;text-align:center;top:2px;font-size:12px;" class="ellipsis" id="note-item-title"></div>
					</div>
					<div style='height:185px;overflow:hidden;position:absolute;top:23px;width:196px;' id="note-scroller-container">
						<div class="note-item" id="note-item-bg" style='overlfow:hidden;height:275px;-apple-dashboard-region: dashboard-region(control rectangle);'></div>
					</div>
					<textarea oncopy="noteController.didCopy()" onmousedown="noteController.monitorForTextareaDrag()" onchange="noteController.noteDidChange()" id="note-item-textarea" onkeyup="noteController.recievedInput(this)" onpaste="setTimeout('noteController.recievedInput(this)', 100)" class="note-item-text" style="left:20px;top:26px;width:155px;overflow:hidden;position:absolute;border:0;height:175px;outline-color:rgb(0, 0, 0, 0);outline-style:none;background-color:transparent;"></textarea>
					<div id="note-content-base">
						<div id="note-item-back" class="note-item-control" onclick="noteController.selectPrevious()"></div>
						<div class="note-content-delete note-item-control-enabled" onclick="noteController.deleteNote()"></div>
						<div id="note-item-forward" class="note-item-control" onclick="noteController.selectNext()"></div>
					</div>
					<div id="note-scroller" class="note-scroller" style="position:absolute;top:26px;left:180px;height:160px;width:12px;"></div>
					<div id="note-resizer" style="position:absolute;top:192px;left:181px;background-image:url(./images/scrollbar/resize.png);height:12px;width:12px;-apple-dashboard-region: dashboard-region(control rectangle);" onmousedown="noteController.beginResizeDrag(event)"></div>
				</div>
				<div style="position:absolute;top:0px;height:104px;background-color:rgba(0, 0, 0, 0.9);width:196px;display:none;z-index:100" id="note-confirmation-windows">
					<div style="display:none;position:absolute;top:0px;height:45px" id="delete-note-window">
						<div class="note-confirm-delete-do" onclick="noteController.doDelete()"></div>
						<div class="note-confirm-delete-cancel" onclick="noteController.cancelDelete()"></div>
					</div>
				</div>
			</div>

			<div id="tab-events" style="z-index:1;height:208px;width:196px;position:absolute;top:0px;visibility:hidden;left:25px;overflow:hidden;background: #d6dbe1 url('image/common/background.png') no-repeat;">
				<div style="position:absolute;top:0px;height:40px;width:196px;overflow:hidden;display:block;" id="event-index-container">
					<div class="event-header">
						<div style="width:146px;left:23px;position:absolute;text-align:center;padding-top:2px;">
							<table border="0" cellspacing="0" cellborder="0" align="center">
								<tr>
									<td width="2"><div style="width:2px;"></div></td>
									<td><div style="max-width:126px;float:left;text-align:center;" class="ellipsis" id="events-calendar-title"></div></td>
									<td width="12"><img src="./images/todo/todo_arrows.png"style="margin-top:2px;margin-left:2px;" /></td>
								</tr>
							</table>
						</div>
						<select style='position:absolute;left:25px;width:146px;top:-1px;opacity:0;' id="event-calendars" onchange="eventsController.switchCalendar(this.options[this.selectedIndex], true)">
							<option value="ALL"></option>
						</select>
						<div class="event-ical" onclick="calendarController.openiCal()"></div>
					</div>
					
					
					<div id="event-index-scroller-container">
						<div style="position:relative;background-image:url(./images/common/background.png);width:196px;overflow:hidden" id="event-index-content"></div>
						<div id="events-noneforday" style="display:none;position:absolute;top:37px;text-align:center;color:black;width:150px;left:23px;font-weight:bold;"><span id="events-noevents-date"></span></div>
					</div>
					
					<div id="event-index-scroller" class="search-scroller" style="position:absolute;top:31px;left:180px;height:160px;width:10px;"></div>
					<div id="event-index-resizer" style="z-index:60;position:absolute;top:192px;left:181px;background-image:url(./images/scrollbar/resize.png);height:12px;width:12px;-apple-dashboard-region: dashboard-region(control rectangle);" onmousedown="eventsController.beginResizeDrag(event)"></div>
				</div>

				<div style="position:absolute;top:0px;height:200px;width:196px;overflow:hidden;display:none" id="event-item-container">
					<div class="event-header">
						<div class="event-back" onclick="eventsController.selectIndex()"></div>
						<div id="event-item-title" style="position:absolute;left:25px;width:146px;font-family:'Lucida Grande';font-size:12px;color:white;text-align:center;top:2px" class="ellipsis"></div>
						<div style="position:absolute;left:25px;width:146px;overflow:hidden;height:20px;">
							<div id="event-item-title-hidden" style="font-family:'Lucida Grande';font-size:12px;color:white;text-align:center;top:2px;opacity:0" class=""></div>
						</div>
						<div class="event-ical" onclick="eventsController.openIcalAndSelectEvent()"></div>
					</div>
					<div id="event-item-scroller-container">
						<div style="position:relative;background: #d6dbe1 url('image/common/background.png') no-repeat;width:196px;overflow:hidden;height:200px;" id="event-item-content">
							<div style="position:absolute;top:6px;" id="event-item-location-container">
								<div class="event-detail-label" id="event-item-location-label"></div>
								<div class="event-detail-value" style="overflow:hidden" id="event-item-location"></div>
							</div>
							
							<div style="position:absolute;" id="event-item-allday-container">
								<div class="event-detail-label" id="event-detail-when-label"></div>
								<div class="event-detail-value"><span id="event-detail-allday"></span><span id="event-detail-allday-suffix"></span</div>
							</div>

							<div style="position:absolute;" id="event-item-tofrom-container">
								<div class="event-detail-label" id="event-item-tofrom-from-label" style="top:0px"></div>
								<div class="event-detail-value" style="top:0px" id="event-item-from"></div>
								<div class="event-detail-label" id="event-item-tofrom-to-label" style="top:30px"></div>
								<div class="event-detail-value" style="top:30px" id="event-item-to"></div>
							</div>

							<div style="position:absolute;" id="event-item-people-container">
								<div class="event-detail-label" id="event-item-people-label"></div>
								<div class="event-detail-value" id="event-item-people"></div>
							</div>

							<div style="position:absolute;" id="event-item-url-container">
								<div class="event-detail-label" id="event-item-url-label"></div>
								<div class="event-detail-value link" id="event-item-url" style="text-overflow: ellipsis;white-space: nowrap;overflow: hidden;"></div>
							</div>

							<div style="position:absolute;" id="event-item-notes-container">
								<div class="event-detail-label" id="event-item-notes-label"></div>
								<div class="event-detail-value" id="event-item-notes"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
					
			<div id="tab-todo" style='z-index:1;height:0px;width:196px;position:absolute;top:0px;visibility:hidden;left:25px;overflow:hidden;'>
				<div style="position:absolute;top:0px;" id="todo-container">
					<div class="todo-header">
						<div style="position:absolute;top:2px;left:25px;width:146px;font-size:12px;text-align:center"></div>
						<div class="todo-button-advanced"></div>
						<select style='position:absolute;left:0px;width:19px;top:-1px;opacity:0' id="todo-advanced-menu" onchange="todoController.advancedMenuChange(this.selectedIndex)">
  							<optgroup label="Sort By">
  								<option value="sort-title" id="todo-sort-auto"></option>
  								<option value="sort-title" id="todo-sort-title"></option>
  								<option value="sort-title" id="todo-sort-priority"></option>
  								<option value="sort-title" id="todo-sort-due"></option>
  								<option value="sort-title" id="todo-sort-calendar"></option>
  							</optgroup>
						</select>
						<div style="width:116px;left:38px;position:absolute;text-align:center;padding-top:2px;" onclick="todoController.showCalendarMenuIndex(event)">
							<table border="0" cellspacing="0" cellborder="0" align="center">
								<tr>
									<td width="2"><div style="width:2px;"></div></td>
									<td><div style="max-width:114px;float:left;text-align:center;" class="ellipsis" id="todo-calendar-title"></div></td>
									<td width="12"><img src="./images/todo/todo_arrows.png"style="margin-left:2px;margin-top:2px;" /></td>
								</tr>
							</table>
						</div>
					</div>
						
					<div id="todo-contents-container">
						<div id="todo-scroller-container">
							<div class="todo-index" id="todo-content" style="position:relative;overflow:hidden;"></div>
						</div>
						<div id="todo-base" class="todo-base" style="bottom:0px;">
							<div id="todo-add-calendar" onclick="todoController.addCalendar()"></div>
							<div id="todo-add-todo" onclick="todoController.addTodo()"></div>
							<div id="todo-delete" class="disabled" onclick="todoController.deleteSelectedTodo()"></div>
							<div id="todo-info" class="disabled" onclick="todoController.viewDetails()"></div>
						</div>
						<div id="todo-scroller" style="position:absolute;top:28px;left:181px;width:10px;display:block;height:10px;"></div>
						<div id="todo-resizer" style="position:absolute;bottom:3px;left:181px;background-image:url(./images/scrollbar/resize.png);height:12px;width:12px;-apple-dashboard-region: dashboard-region(control rectangle);" onmousedown="todoController.beginResizeDrag(event)"></div>
					</div>
					<div style="position:absolute;top:0px;height:104px;background-color:rgba(0, 0, 0, 0.9);width:196px;display:none;z-index:100" id="todo-confirmation-windows">
						<div style="display:none;position:absolute;top:0px;height:63px;" id="todo-add-new-calendar-window">
							<div style="position:absolute;left:21px;top:0px;width:154px;text-align:center;text-shadow: rgba(0,0,0,0.2) 0px 2px 1px;font: normal 12px/16px 'Lucida Grande';color:white">Create new calendar:</div>
							<div onclick="todoController.cancelCalAdd();" class="todo-add-cal-cancel"></div>
							<div onclick="todoController.doCalAdd()" class="todo-add-cal-do"></div>
							<form onsubmit="todoController.doCalAdd();return false">
								<input id="todo-new-cal-name" type="text" style="background-color:transparent;width:154px;height:20px;left:21px;position:absolute;top:18px;background-image:url(./images/todo/textfield_cal.png);border:0px;background-repeat:no-repeat;" />
							</form>
						</div>
					
						<div style="display:none;position:absolute;top:0px;height:45px" id="delete-todo-window">
							<div class="todo-confirm-delete-do" onclick="todoController.doDelete()"></div>
							<div class="todo-confirm-delete-cancel" onclick="todoController.cancelDelete()"></div>
						</div>
					
						<div style="display:none;height:65px;position:absolute" id="add-todo-calendar-selector-window">
							<div style="position:absolute;left:21px;top:0px;width:154px;text-align:center;text-shadow: rgba(0,0,0,0.2) 0px 2px 1px;font: normal 12px/16px 'Lucida Grande';color:white">Add To Do to calendar:</div>
							<div style="background-image:url(./images/todo/button_callistmenu.png);width:154px;height:20px;left:21px;position:absolute;top:18px;"></div>
							<div onclick="todoController.cancelTodoAdd()" class="todo-add-todo-cancel"></div>
							<div onclick="todoController.doTodoAdd()" class="todo-add-todo-do"></div>
							<div id="todo-newtodo-calendar-title" class="ellipsis" style=""></div>
							<select style="position:absolute;top:17px;width:140px;left:30px;opacity:0" id="todo-newtodo-calendars" onchange="todoController.changeNewTodoCalendar(this.options[this.selectedIndex]);"></select>
						</div>
					</div>
				</div>
				<div id="todo-item-container"  style="position:absolute;top:0px;display:none;width:196px;height:0px;">
					<div class="todo-header" style="position:absolute;">
						<div class="event-back" onclick="todoController.selectIndex()"></div>
						<div style="position:absolute;left:25px;width:146px;font-family:'Lucida Grande';font-size:12px;color:white;text-align:center;top:2px" class="ellipsis" id="todo-details-page-label"></div>
					</div>
					<div style="position:absolute;top:23px;left:0px;width:196px;" id="todo-item-scroller-container">
						<div style="width:196px;position:absolute;" id="todo-item-content">
							<div onblur="todoController.finishedEditingTitle()" id="todo-item-title" onkeypress="setTimeout('todoController.kpFromTitle()', 0)" contentEditable="true" style="display:block;-khtml-user-modify:read;-khtml-user-select:text;font:bold 11px/14px 'Lucida Grande';color:black;position:absolute;top:6px;left:5px;width:186px;"></div>
						
							<div id="todo-item-calendar-container" style="position:absolute;left:5px;">
								<div onclick="todoController.showCalendarMenu(event);" id="todo-item-calendar-label" style="height:13px;overflow:hidden;max-width:174px;font:bold 11px/14px 'Lucida Grande';color:black;position:absolute;top:3px;background-image:url(./images/todo/todo_arrows.png);background-repeat:no-repeat;background-position:3px right;padding-right:10px;" class="ellipsis">
									<span id="todo-details-calendar-label" style="float:left;color:rgba(0,0,0,0.6);"></span>
								</div>
							</div>
							<div id="todo-item-priority-container" style="position:absolute;left:5px;">
								<div id="todo-item-priority-label" style="height:13px;overflow:hidden;max-width:174px;font:bold 11px/14px 'Lucida Grande';color:black;position:absolute;top:3px;background-image:url(./images/todo/todo_arrows.png);background-repeat:no-repeat;background-position:3px right;padding-right:10px;" class="ellipsis">
									<span id="todo-details-priority-label" style="float:left;color:rgba(0,0,0,0.6);"></span>
								</div>
								<select style="width:175px;height:10px;overflow:hidden;opacity:0;position:absolute;top:0px;left:0px;" id="todo-item-priority" onchange="todoController.setPriority(this.selectedIndex)">
									<option id="todo-details-priority-none"></option>
									<option id="todo-details-priority-low"></option>
									<option id="todo-details-priority-medium"></option>
									<option id="todo-details-priority-high"></option>
								</select>
							</div>
							<div id="todo-item-url-container" style="position:absolute;left:5px;">
								<form onsubmit="return false">
									<input class="todo-url-editor todo-item-label" style="position:absolute;top:2px;left:29px;max-width:153px;font:bold 11px/14px 'Lucida Grande';opacity:0;" id="todo-item-url-editor" onchange="todoController.finishedEditingURL()" onblur="todoController.finishedEditingURL()" />
								</form>
								<div style="font:bold 11px/14px 'Lucida Grande';color:rgba(0,0,0,0.6);position:absolute;top:3px;white-space:nowrap;float:left;" id="todo-details-url-label"></div>
								<div style="position:absolute;top:3px;left:33px;width:153px;" onclick="todoController.beginEditingURL()" id="todo-url-goto-container">
									<div id="todo-item-url-label" class="ellipsis"></div>
									<div style="background-image:url(./images/todo/url.png);height:11px;width:12px;float:left;background-position:4px 3px;background-repeat:no-repeat;" id="todo-goto-url"></div>
								</div>
							</div>
							<div id="todo-item-notes-container" style="position:absolute;left:5px;">
								<div style="font:bold 11px/14px 'Lucida Grande';color:rgba(0,0,0,0.6);position:absolute;top:3px;"><span id="todo-details-notes-label"></span>:</div>
							</div>
							
							<div style="position:absolute;color:rgba(0,0,0,0.5);left:5px;" id="todo-item-notes-placeholder"></div>
							<div onfocus="todoController.startedEditingNotes()" onblur="todoController.finishedEditingNotes()" id="todo-item-notes" onkeypress="setTimeout('todoController.kpFromNotes()', 0)" contentEditable="true" style="display:block;-khtml-user-modify:read;-khtml-user-select:text;font:bold 11px/14px 'Lucida Grande';color:black;position:absolute;top:6px;left:5px;width:186px;"></div>
						</div>
					</div>
					<div id="todo-item-base" class="todo-item-base" style="bottom:0px;"></div>
				</div>
			</div>
		</div>
		<div id="clock-drag-shadow"></div>
		<div id="clock-drag-shadow-mini"></div>

		<div id="todo-calendar-cmenu" style="max-width:180px;background-color:white;position:absolute;display:none;z-index:1000;font: normal normal 13px 'Lucida Grande';border: 1px solid rgba(0,0,0,0.25);-webkit-border-radius: 5px;-webkit-box-shadow: 0 10px 30px rgba(0,0,0,0.35);">
			<div id="todo-calendar-cmenu-inner" style="background: rgba(255,255,255,0.95);-webkit-border-radius: 0px;margin:5px 0;padding:0 0px;color:black;">
			</div>
		</div>
	</div>

		<div style="z-index:101;position:absolute;top:0px;left:11px;display:none" id="updater-new">
			<div style="background:url(./images/update/top.png) no-repeat;width:224px;height:40px;position:relative;">
				<div style="background-image:url(./images/update/middle.png);width:224px;height:27px;position:absolute;top:13px;"></div>
				<div style="background-image:url(./images/update/shine.png);height:9px;width:224px;position:absolute;top:13px;"></div>
				<div style="font-family:'Lucida Grande';font-size:12px;color:white;padding-left:15px;top:10px;font-weight:bold;position:absolute;text-shadow: rgba(0,0,0,1.0) 0px 2px 1px;">A new version of Organized is available. Download it now?</div>
			</div>
			<div style="background-image:url(./images/update/middle.png);width:224px;;position:relative;">
				<div style="color:#6ba6ff;padding-top:5px;padding-left:15px;text-shadow: rgba(0,0,0,1.0) 0px 2px 1px;font-weight:bold;padding-bottom:3px;">New Features</div>
				
				<div style="padding-left:18px;text-shadow: rgba(0,0,0,1.0) 0px 2px 1px;font-weight:bold;overflow:hidden;" id="updateCheckerNewFeaturesScrollerContainer">
					<ul id="updateCheckerNewFeatures" style="margin:0px;padding:0px;margin-left:18px;">
					</ul>
				</div>
				<div id="updateCheckerNewFeaturesScroller" class="update-scroller" style="position:absolute;top:8px;left:195px;height:75px;width:10px;"></div>
				
				<div style="position:relative;height:22px;padding-top:3px;">
					<div class="update-download" onclick="updateController.get()"></div>
					<div class="update-later" onclick="updateController.later()"></div>
					<div class="update-skip" onclick="updateController.skip()"></div>
				</div>
				
			</div>
			<div style="background-image:url(./images/update/bottom.png);width:224px;height:18px;position:relative;"></div>
		</div>

		<div style="z-index:101;position:absolute;top:90px;left:11px;display:none" id="updater-current">
			<div style="background:url(./images/update/top.png) no-repeat;width:224px;height:40px;position:relative;">
				<div style="background-image:url(./images/update/middle.png);width:224px;height:27px;position:absolute;top:13px;"></div>
				<div style="background-image:url(./images/update/shine.png);height:9px;width:224px;position:absolute;top:13px;"></div>
				<div style="width:194px;font-family:'Lucida Grande';font-size:12px;color:white;padding-left:15px;top:10px;position:absolute;text-shadow: rgba(0,0,0,1.0) 0px 2px 1px;text-align:center">You have the latest version<br/>of Organized</div>
			</div>
			<div style="background-image:url(./images/update/middle.png);width:224px;;position:relative;">
				<div style="position:relative;height:22px;padding-top:10px;">
					<div class="update-ok" onclick="updateController.hide()"></div>
				</div>
				
			</div>
			<div style="background-image:url(./images/update/bottom.png);width:224px;height:18px;position:relative;"></div>
		</div>
		
		<div id="behind" style='opacity:0;position:absolute;top:0px;left:0px;'>
			<div style='position:absolute;top:0px;z-index:100;width:246px;' id="back-updater-mask"></div>
			<div style='background-image:url(./images/back/back_top.png);width:246px;height:76px;'>
				<div id="pref-tab-buttons">
					<div class="pref-tab pref-tab-selected" id="pref-tab-general" onclick="p.selectTab(0)"></div>
					<div class="pref-tab pref-tab-unselected" id="pref-tab-clocks" onclick="p.selectTab(1)"></div>
					<div class="pref-tab pref-tab-unselected" id="pref-tab-cal" onclick="p.selectTab(2)"></div>
				</div>
				<div style="position:absolute;top:20px;left:75px;width:95px;height:25px;" onclick="widget.openURL('http://islayer.com')"></div>
			</div>
			<div style='width:246px;height:29px;position:absolute;top:76px;' id="back-middle"></div>

			<div id="pref-tab-container" style="position:absolute;top:81px;width:246px;overflow:hidden;">
				<div id="prefs-general-tab" style="position:absolute;top:0px;width:246px;">
					<div onclick="" style='color:white;font-size:11px;background-image:url(./images/back/listmenu.png);width:186px;height:20px;position:absolute;top:0px;left:30px;'>
						<div style="color:white;font-size:11px;padding-top:3px;padding-left:3px;width:86px;" id="event-days-text-label" class="ellipsis"></div>
						<div style="width:80px;height:21px;left:95px;top:3px;position:absolute;color:#222222;font-size:11px;font-family:'Lucida grande'" id="event-days-text" class="ellipsis"></div>
						<select onchange="p.setEventDays(this.options[this.selectedIndex])" id="event-days-menu" style="width:94px;height:21px;left:90px;position:absolute;opacity:0;top:0px;">
							<option value="1"></option>
							<option value="2"></option>
							<option value="3"></option>
							<option value="4"></option>
							<option value="5"></option>
							<option value="6"></option>
							<option value="7"></option>
							<option value="10"></option>
							<option value="14"></option>
							<option value="31"></option>
						</select>
					</div>
					
					<div onclick="p.checkboxAction(this)" id="pref-24hr" class="unchecked" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:24px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-font" class="unchecked" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:40px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-hidecompleted" class="unchecked" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:72px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-hidecompletedimmedite" style='margin-left:18px;color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:88px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-animation" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:104px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-updates" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:120px;left:30px;'></div>
					
					<div onclick="p.checkboxAction(this)" id="pref-disableconfirmations" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:136px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-showtododuedates" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:56px;left:30px;'></div>
					
					<div onclick='updateController.check(false)' class='update'></div>
					<div onclick='widget.openURL("http://islayer.com/paypal.php")' class='donate' style="position:absolute;top:189px;left:30px;"></div>
				</div>
				
				<div id="prefs-clock-tab" style="position:absolute;top:0px;width:246px;display:none;">
					<div style='position:absolute;top:0px;height:21px;width:182px;left:32px;overflow:hidden' id="pref-search-container">
						<div class="search-header search-header-inactive" id="search-header"></div>
						<div id="pref-search-footer" style='background-image:url(./images/back/searchresults_bottom.png);height:20px;width:182px;position:absolute;top:84px;left:0px;'></div>
						<input placeholder="" id="pref-clock-search" incremental="true" onsearch="p.dosearch(this.value)" type="text" style="position:absolute;top:1px;left:18px;width:145px;border:0px;outline:none;background-color:transparent;" onchange="p.dosearch(this.value)" />
						<div id="pref-clock-search-close" class="search-close" onclick="p.endSearch()"></div>
						<div id="search-results-container" style="display:none;height:81px;overflow:hidden;position:absolute;top:21px;left:0px;">
							<div id="search-results-content" style="width:182px;height:60px;overflow:hidden;background-image:url(./images/back/searchresults_mid.png);"></div>
						</div>
						<div id="pref-search-scroller" class="pref-search-scroller" style="position:absolute;top:26px;left:164px;height:69px;width:10px;display:none;"></div>
					</div>
		
					<div onclick="" style='background-image:url(./images/back/listmenu.png);width:186px;height:20px;position:absolute;bottom:46px;left:30px;'>
						<div style="color:white;font-size:11px;padding-top:3px;padding-left:3px;width:86px;" id="clock-mode-text-label" class="ellipsis">Clock size</div>
						<div style="width:80px;height:21px;left:95px;top:3px;position:absolute;color:#222222;font-size:11px;font-family:'Lucida grande'" id="clock-mode-text" class="ellipsis"></div>
						<select onchange="p.setClockMode(this.options[this.selectedIndex])" id="clock-mode-menu" style="width:94px;height:21px;left:90px;position:absolute;opacity:0;top:0px;">
							<option value="0"></option>
							<option value="1"></option>
						</select>
					</div>
					<div onclick="p.checkboxAction(this)" id="pref-clockticks" class="checked" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;bottom:68px;left:30px;'></div>
					<div onclick='widget.openURL("http://islayer.com/paypal.php")' class='donate' style="position:absolute;bottom:16px;left:30px;"></div>
					
					<div style='position:absolute;top:5px;width:182px;height:110px;display:block;left:32px;' id="pref-clock-container"></div>
				</div>
				<div id="prefs-cal-tab" style="position:absolute;top:0px;width:246px;display:none;">
				
					<div style="background-image:url(./images/back/listmenu.png);width:186px;height:20px;left:30px;position:absolute;">
						<div style="color:white;font-size:11px;padding-top:3px;padding-left:3px;width:86px;" id="calendar-day-text-label" class="ellipsis"></div>
						<div style="width:80px;height:21px;left:95px;top:3px;position:absolute;color:#222222;font-size:11px;font-family:'Lucida grande'" class="ellipsis" id="calendar-day-text"></div>
						<select onchange="p.setFirstDay(this.options[this.selectedIndex])" id="calendar-day-menu" style="width:94px;height:21px;left:90px;position:absolute;opacity:0;top:0px;">
							<option value="0"></option>
							<option value="1"></option>
							<option value="2"></option>
							<option value="3"></option>
							<option value="4"></option>
							<option value="5"></option>
							<option value="6"></option>
						</select>
					</div>
					<div style="background-image:url(./images/back/divider.png);width:200px;height:2px;left:23px;position:absolute;top:24px;"></div>
					<div onclick="p.checkboxAction(this)" id="pref-filterevents" class="unchecked" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:30px;left:30px;'></div>
					<div onclick="p.checkboxAction(this)" id="pref-filtertodos" class="unchecked" style='color:white;font-size:11px;background-image:url(./images/back/check.png);background-repeat:no-repeat;padding-left:18px;padding-top:1px;width:173px;height:15px;position:absolute;top:46px;left:30px;'></div>
					<div style="background-image:url(./images/back/divider.png);width:200px;height:2px;left:23px;position:absolute;top:66px;"></div>
				
					<div id="pref-cal-scroller-container" style="height:200px;position:absolute;left:30px;width:163px;top:72px;">
						<div class="pref-cal-content" id="pref-cal-content" style="position:absolute;overflow:hidden;"></div>
					</div>
					<div id="pref-cal-scroller" class="update-scroller" style="position:absolute;top:72px;left:203px;width:10px;display:block;height:200px;"></div>
				</div>
			</div>		
			<div style='background-image:url(./images/back/back_bottom.png);width:246px;height:66px;position:absolute;top:249px;' id="pref-base">
				<div style="position:absolute;coloe:white;top:17px;left:33px;font-size:9px;font-wight:bold;">1.1</div>
				<div id="done" onclick='doneMouseUp()' class='done'></div>
			</div>
			
			<div id="pref-base-contents" style="position:absolute;left:30px;">
			</div>
		</div>	
	</body>	<script>
	
	window.resizeTo(246, 500);
	
	var scrollBarMonitoringTimer = null;
	var eventMarker = document.createElement("div");
	eventMarker.setAttribute("id", "event-marker");

	loadAnimator = new AnimationController();
	p = new Prefs();		
	todoController = new Todos();
	clockController = new Clocks();
	noteController = new Notes();
	eventsController = new Events();
	tabController = new TabController();
	calendarController = new Calendar();
	updateController = new Updater();
	
	var osClass = "";

	function getLocalizedString(key){
		try {
			var ret = localizedStrings[key];
			if (ret === undefined)
				ret = key;
			return ret;
		} catch (ex) {}
		
		return key;
	}
	
	function setupFonts(){
		if(p.v("marker felt") == "0"){
			document.getElementById("note-index-container").setAttribute("class", "mf-font");
			document.getElementById("note-item-container").setAttribute("class", "mf-font");
			document.getElementById("todo-content").setAttribute("class", "todo-index mf-font");
		} else {
			document.getElementById("note-index-container").setAttribute("class", "nomf-font");
			document.getElementById("note-item-container").setAttribute("class", "nomf-font");
			document.getElementById("todo-content").setAttribute("class", "todo-index nomf-font");
		}
	}
	
	function updateCalendarDayNames(){
		var weekstart = parseInt(p.v("week start"));
		Organized.setWeekStartDay(weekstart);

		var startdaynames = Array("S", "M", "T", "W", "T", "F", "S", "S", "M", "T", "W", "T", "F", "S");
		var start = 0;
		switch(weekstart){
			case 1:
				start = 1;
			break;
			case 2:
				start = 2;
			break;
			case 3:
				start = 3;
			break;
			case 4:
				start = 4;
			break;
			case 5:
				start = 5;
			break;
			case 6:
				start = 6;
			break;
		}
		
		var added = 0;
		for(x=start;x<startdaynames.length;x++){
			document.getElementById("calendar-dayname-" + added).innerText = startdaynames[x];
			added++;
			if(added == 7)
				break;
		}
	}
	
	function setupLocalizedObjects(){
		document.getElementById("note-index-count-label").innerHTML = getLocalizedString("Notes");
		document.getElementById("events-calendar-title").innerHTML = getLocalizedString("All Calendars");
		document.getElementById("event-calendars").options[0].text = getLocalizedString("All Calendars");
		document.getElementById("event-item-location-label").innerHTML = getLocalizedString("Location");
		document.getElementById("event-detail-when-label").innerHTML = getLocalizedString("When");
		document.getElementById("event-detail-allday-suffix").innerHTML = ", " + getLocalizedString("All Day");
		document.getElementById("event-item-tofrom-from-label").innerHTML = getLocalizedString("From");
		document.getElementById("event-item-tofrom-to-label").innerHTML = getLocalizedString("To");
		document.getElementById("event-item-people-label").innerHTML = getLocalizedString("People");
		document.getElementById("event-item-url-label").innerHTML = getLocalizedString("URL");
		document.getElementById("event-item-notes-label").innerHTML = getLocalizedString("Notes");
		document.getElementById("todo-sort-auto").innerHTML = getLocalizedString("Auto");
		document.getElementById("todo-sort-title").innerHTML = getLocalizedString("Title");
		document.getElementById("todo-sort-priority").innerHTML = getLocalizedString("Priority");
		document.getElementById("todo-sort-due").innerHTML = getLocalizedString("Due Date");
		document.getElementById("todo-sort-calendar").innerHTML = getLocalizedString("Calendar");
		document.getElementById("todo-calendar-title").innerHTML = getLocalizedString("All Calendars");
//		document.getElementById("todo-calendars").options[0].text = getLocalizedString("All Calendars");
		document.getElementById("todo-details-page-label").innerHTML = getLocalizedString("To Do Details");
		document.getElementById("todo-details-calendar-label").innerHTML = getLocalizedString("Calendar") + ":&nbsp;";
		document.getElementById("todo-details-priority-label").innerHTML = getLocalizedString("Priority") + ":&nbsp;";
		document.getElementById("todo-details-priority-none").innerHTML = getLocalizedString("None");
		document.getElementById("todo-details-priority-low").innerHTML = getLocalizedString("Low");
		document.getElementById("todo-details-priority-medium").innerHTML = getLocalizedString("Medium");
		document.getElementById("todo-details-priority-high").innerHTML = getLocalizedString("High");
		document.getElementById("todo-details-url-label").innerHTML = getLocalizedString("URL") + ":&nbsp;";
		document.getElementById("todo-details-notes-label").innerHTML = getLocalizedString("Notes");
		document.getElementById("todo-item-notes-placeholder").innerHTML = getLocalizedString("No Notes");

		document.getElementById("event-days-menu").options[0].text = getLocalizedString("Today");
		document.getElementById("event-days-menu").options[1].text = getLocalizedString("Next %@ days").replace("%@", 2);
		document.getElementById("event-days-menu").options[2].text = getLocalizedString("Next %@ days").replace("%@", 3);
		document.getElementById("event-days-menu").options[3].text = getLocalizedString("Next %@ days").replace("%@", 4);
		document.getElementById("event-days-menu").options[4].text = getLocalizedString("Next %@ days").replace("%@", 5);
		document.getElementById("event-days-menu").options[5].text = getLocalizedString("Next %@ days").replace("%@", 6);
		document.getElementById("event-days-menu").options[6].text = getLocalizedString("Next %@ days").replace("%@", 7);
		document.getElementById("event-days-menu").options[7].text = getLocalizedString("Next %@ days").replace("%@", 10);
		document.getElementById("event-days-menu").options[8].text = getLocalizedString("Next %@ weeks").replace("%@", 2);
		document.getElementById("event-days-menu").options[9].text = getLocalizedString("Next month");

		document.getElementById("calendar-day-menu").options[0].text = getLocalizedString("Sunday");
		document.getElementById("calendar-day-menu").options[1].text = getLocalizedString("Monday");
		document.getElementById("calendar-day-menu").options[2].text = getLocalizedString("Tuesday");
		document.getElementById("calendar-day-menu").options[3].text = getLocalizedString("Wednesday");
		document.getElementById("calendar-day-menu").options[4].text = getLocalizedString("Thursday");
		document.getElementById("calendar-day-menu").options[5].text = getLocalizedString("Friday");
		document.getElementById("calendar-day-menu").options[6].text = getLocalizedString("Saturday");
		
		document.getElementById("clock-mode-menu").options[0].text = getLocalizedString("Small");
		document.getElementById("clock-mode-menu").options[1].text = getLocalizedString("Large");
		
		document.getElementById("event-days-text-label").innerHTML = getLocalizedString("Show events for");
		document.getElementById("pref-clock-search").setAttribute("placeholder", getLocalizedString("Search cities"));
		document.getElementById("calendar-day-text-label").innerHTML = getLocalizedString("Start week on");
		
	}
	
	function doSetup(){
		Organized.updateCityList(p.currentClocks().join());
		
		setupLocalizedObjects();
		updateCalendarDayNames();

		var outFade = new AnimationObject(document.getElementById("loading-image"));
		var inFade = new AnimationObject(document.getElementById("front"));

		inFade.setOptions(0, 10);
		inFade.pushPhase(kAnimateOpacity, 0, 1, 10, 0)
		outFade.setOptions(kAnimateOptionsHide, 20);
		outFade.pushPhase(kAnimateOpacity, 1, 0, 10, 0)
		
		loadAnimator.pushGroup(Array(inFade, outFade));
		loadAnimator.prepare(300, 10);
		loadAnimator.run();
		
		setupFonts();
		preloadImages();
		
		if(Organized.isTenFiveTwoOrAbove() == 1)
			osClass = "tenfive-two";
		else
			osClass = "tenfive-pretwo";
		focus();
		
		document.getElementById("behind").style.display = "none";
		document.getElementById("behind").style.opacity = 1;

		p.setup();
		p.updateUILayout();
		p.resize();
		
		if(widget.onhide == null)
			widget.onhide = hide;

		window.onfocus = focus;
		window.onblur = blur;
		document.addEventListener("keyup", keyUp, false);
		document.addEventListener("keypress", keyPress, false);
		document.addEventListener("keydown", keyDown, false);
		
		calendarController.buildCalendar();
		calendarController.update();

		document.getElementById("main-date").innerHTML = Organized.getCurrentDateDisplay();
		updateCalendarList();

		todoController.buildDisplay();
		todoController.restoreDisplayFromPrefs();
		todoController.animateResize = false;
		todoController.updateDisplay();
		todoController.resize();
	
		clockController.setup();
		clockController.buildDisplay();
		clockController.updateDisplay();
		clockController.updateClocks();
	
		noteController.buildDisplay();
		noteController.restoreDisplayFromPrefs();
		noteController.updateDisplay();
		
		eventsController.buildDisplay();
		eventsController.restoreDisplayFromPrefs();
		eventsController.fetchDataForSelectedDate();
		eventsController.updateDisplay(null);
		
		if(widget.preferenceForKey("tab") != null){
			var tab = widget.preferenceForKey("tab");
			if(tab == 1){
				noteController.selectTab();
				noteController.didSelect();
				noteController.resize();
				noteController.tabElement().style.visibility = "visible";
				noteController.resize();
				tabController.selectedTab = 1;
			} else if(tab == 2){
				eventsController.selectTab();
				eventsController.didSelect();
				eventsController.resize();
				eventsController.tabElement().style.visibility = "visible";
				eventsController.resize();
				tabController.selectedTab = 2;
			} else if(tab == 3){
				todoController.selectTab();
				todoController.didSelect();
				todoController.resize();
				todoController.tabElement().style.visibility = "visible";
				todoController.resize();
				tabController.selectedTab = 3;
			} else {
				clockController.selectTab();
				clockController.didSelect();
				clockController.resize();
				clockController.tabElement().style.visibility = "visible";
				clockController.resize();
				tabController.selectedTab = 0;
			}
		} else {
			clockController.selectTab();
			clockController.didSelect();
			clockController.resize();
			clockController.tabElement().style.visibility = "visible";
			tabController.selectedTab = 0;
		}
		
		updateController.setup();
		if(p.v("update checker") == "1")
			updateController.check(true);
				
		document.getElementById("updater-new").setAttribute("class", osClass);
	}
	

	function focus(){
		document.getElementById("front").setAttribute("class", "focus " + osClass);
	}

	function blur(){
		document.getElementById("front").setAttribute("class", "nofocus " + osClass);
	}	
	
	function updateCalendarList(){
		todoController.menu.removeItems();
		
		var foundFirst = false;
		var cals = Organized.allCalendars();
		document.getElementById("event-calendars").options.length = 1;
		document.getElementById("todo-newtodo-calendars").options.length = 0;
		for(x=0;x<cals.length;x++){
			if(p.v("filter event calendars") == "0" || (p.v("filter event calendars") == "1" && p.isCalendarEnabled(cals[x][1])))
					document.getElementById("event-calendars").options[document.getElementById("event-calendars").options.length] = new Option(cals[x][0], cals[x][1]);
			
			if(cals[x][2] == 1){
				if(p.v("filter todo calendars") == "1" && !p.isCalendarEnabled(cals[x][1]))
					continue;
					
				if(!foundFirst)
					document.getElementById("todo-newtodo-calendar-title").innerHTML = cals[x][0];
				foundFirst = true;
				document.getElementById("todo-newtodo-calendars").options[document.getElementById("todo-newtodo-calendars").options.length] = new Option(cals[x][0], cals[x][1]);
				
				var menuitem = new CustomMenuItem(cals[x]);
				todoController.menu.addItem(menuitem);
			}
		}
		if(!foundFirst)
			document.getElementById("todo-newtodo-calendar-title").innerHTML = getLocalizedString("No Calendars");
	}
		
		
	function focusSearch(){
		resultsFocus = false;
	}
	
	function blurSearch(){
		resultsFocus = true;
	}
		
	function highlightCity(element){
		element.setAttribute("class", "city-search-item city-search-highlight");
		element.focus()
		selectedResult = element;
		for(x=0;x<searchResultContainers.length;x++){
			if(searchResultContainers[x].container != element)
				searchResultContainers[x].container.setAttribute("class", "city-search-item");
		}	
	}
			
	function updateCitiesMenu(option){
		document.getElementById("citiesMenu").options.length = 0;
		var cities = Organized.citiesForLocation(option.value);
		for(x=0;x<cities.length;x++){
			document.getElementById("citiesMenu").options[x] = new Option(cities[x], cities[x]);
		}
	}
	
	function addCity(){
		var city = document.getElementById("citiesMenu").options[document.getElementById("citiesMenu").selectedIndex].value;
		Organized.addCity(city);
		rebuildCities();
		var height = parseInt(document.defaultView.getComputedStyle(document.getElementById("front"),"").getPropertyValue("height"));
		window.resizeTo(590, height);
	}
	

	function removeCity(){
	}


function keyPress(event) {
	if(tabController.selectedTab == 3 && !todoController.viewingtodo){
		if(todoController.selectedTodo && todoController.selectedTodo.isEditing)
			return;
		else if(!todoController.selectedTodo && (event.charCode == 63233 || event.charCode == 63232)){
			todoController.selectFirstTodo();
			event.stopPropagation();
			event.preventDefault();
			return;
		}
		
		//down 
		if(event.charCode == 63233){
			todoController.rowDown();
			event.stopPropagation();
			event.preventDefault();
		}
		//up 
		if(event.charCode == 63232){
			todoController.rowUp();
			event.stopPropagation();
			event.preventDefault();
		}
	}
}

function keyUp(event) {
	if(updateController.visible)
		return;
	
	if(event.target == document.getElementById("todo-item-title")){
		if(event.charCode == 13){
			event.stopPropagation();
			event.preventDefault();
			document.getElementById("todo-item-title").blur();
		}
		return;
	}

	if(event.target == document.body){
		if (event.metaKey)
			return; 
		
		window.focus()
		var realKey = String.fromCharCode(event.charCode).toLowerCase();

		if((realKey == "1" || realKey == "c") && tabController.selectedTab != 0)
			tabController.selectTab(0)

		if((realKey == "2" || realKey == "n") && tabController.selectedTab != 1)
			tabController.selectTab(1);

		if((realKey == "3" || realKey == "e") && tabController.selectedTab != 2)
			tabController.selectTab(2);

		if((realKey == "4" || realKey == "t") && tabController.selectedTab != 3)
			tabController.selectTab(3);

		if(realKey == "d" && tabController.selectedTab == 0 && !clockController.drag.active)
			clockController.switchMode();
		
		if(event.charCode == 63234){ // Back a page
			if(tabController.selectedTab == 1){
				tabController.selectTab(0);
			} else if(tabController.selectedTab == 2){
				tabController.selectTab(1);
			} else if(tabController.selectedTab == 3){
				tabController.selectTab(2)
			} else {
				tabController.selectTab(3);
			}
		}
		if(event.charCode == 63235){ // Foward a page
			if(tabController.selectedTab == 1){
				tabController.selectTab(2)
			} else if(tabController.selectedTab == 2){
				tabController.selectTab(3);
			} else if(tabController.selectedTab == 3){
				tabController.selectTab(0);
			} else {
				tabController.selectTab(1);
			}
		}

		var eventKeys = Array(3, 13, 27, 8, 63272)
		var controller = tabController.controllerForTab(tabController.selectedTab);
		if(controller.inConfirmation()){
			for(x=0;x<eventKeys.length;x++){
				if(event.charCode == eventKeys[x]){
					controller.respondToKey(event.charCode)
				}
			}
		} else if(tabController.selectedTab == 3){
			for(x=0;x<eventKeys.length;x++){
				if(event.charCode == eventKeys[x]){
					controller.respondToKey(event.charCode)
				}
			}
		}
	}

}

function keyDown(event){
	if(event.target == document.body){
		if (event.metaKey)
			return;
		event.stopPropagation();
		event.preventDefault();
	}
}

function resizeFront(height){
	if(p.active)
		return;
		
	window.resizeTo(window.outerWidth, height);	
	if(updateController.visible)
		updateController.show();
}

	function hide(){
		noteController.onHide();
		todoController.onHide();
	}
	
	function preloadImages(){
		var images = Array();
		images.push("./images/back/searchresults_top.png");	
		images.push("./images/back/clock_item_shadow.png");	
		images.push("./images/clocks/clock_background.png");	
		images.push("./images/clocks/clock_item_dragshadow.png");	
		images.push("./images/clocks/clock_item_drag.png");	
		images.push("./images/clocks/clocksmall_background.png");	
		images.push("./images/clocks/clocksmall_item_drag.png");	
		images.push("./images/clocks/clocksmall_item_dragshadow.png");	
		images.push("./images/clocks/clocksmall_item.png");	
		images.push("./images/clocks/clock_item.png");	
		images.push("./images/common/middle_nofocus.png");	
		images.push("./images/scrollbar/barbottom_todo_down.png");	
		images.push("./images/scrollbar/barbottom_down.png");	
		images.push("./images/scrollbar/barmid_down.png");	
		images.push("./images/scrollbar/barmid_todo_down.png");	
		images.push("./images/scrollbar/bartop_down.png");	
		images.push("./images/scrollbar/bartop_todo_down.png");	

		for(x=0;x<images.length;x++){
			var img = new Image();
			img.src = images[x];
		}
	}

	</script>	</html>		